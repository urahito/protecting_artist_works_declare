# 母比率の検定（投票・アンケートの過半数ラインの可能性）
<!-- <title>母比率の検定（投票・アンケートの過半数ラインの可能性）</title> -->

※免責：統計の入門書をかじっただけなので、不正確な内容や不十分な説明があります。

統計において、母比率の推定には一般に以下の検定統計量$T$についての式が近似的に用いられます。

```math
\begin{equation}
T=\frac{p_0-p}{\sqrt{\frac{p(1-p)}{N}}}
\end{equation}
```

ここで、$p$は「確かめたい（検定対象の）割合」（母比率）、$p_0$は任意の回答Aの実割合（標本比率）、$N$は投票数（サンプル数）です。

## 確かめたい割合を50%としたとき

さらに、「ある過半数(>50%)の項目の母比率（サンプル数が十分に多いときの割合）が実は50%じゃないか？」と仮定して、この母比率の検定を行うとすると、式(1)は$p=0.5$を代入して、

```math
\begin{align*}
T&=\frac{p_0-0.5}{\sqrt{\frac{0.5\cdot(1-0.5)}{N}}} \\
&=\frac{p_0-0.5}{\sqrt{\frac{\frac{1}{2}\cdot\frac{1}{2}}{N}}} \\
&=\frac{p_0-0.5}{\sqrt{\frac{\frac{1}{4}}{N}}} \\
&=\frac{p_0-0.5}{\sqrt{\frac{1}{4N}}} \\
&=\frac{p_0-0.5}{\frac{1}{\sqrt{4N}}} \\
&=\frac{p_0-0.5}{\frac{1}{2\sqrt{N}}} \\
&=2\sqrt{N}(p_0-0.5)
\end{align*}
```

より、$p=0.5$(50%)を母比率と仮定したときの検定統計量は、

```math
\begin{equation}
T=2\sqrt{N}(p_0-0.5)\quad～N(0,1)
\end{equation}
```

であると整理出来ます。（これが標準正規分布$N(0,1)$に近似的に従います）

## 過半数超え（割れ）の確率を求める

あとは、標準正規分布の計算をツールサイトや表計算ソフト（NORM.S.DIST(式(2)で求めた$T$,TRUE)）で「下側(上側)累積確率」を求めると、「投票の任意の回答Aの割合 $p0$ と投票数$N$から、回答Aが50%を上回る（下回る）可能性」を求めることが出来ます（出来るはずです）。

※このとき、$p_0>0.5$(>50%)のときは「下側累積確率」、$p_0<0.5$(<50%)のときは「上側累積確率」を使用してください。

- カシオの[高精度計算機サイト](https://keisan.site/exec/system/1174204351)
- 表計算ソフトの場合
  - 下側累積確率: NORM.S.DIST(式(3)のT, TRUE) ($p_0$>0.5)
  - 上側累積確率: __1-__ NORM.S.DIST(式(3)のT, TRUE) ($p_0$<0.5)
