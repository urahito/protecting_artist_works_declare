# 補足資料：生成ＡＩの直感的理解のための「ファジイ論理」

## 免責事項

本資料の本文について言及する場合、以下の事項に同意するものとみなし、苦情や批判に対しては対応いたしません。  

- 以下は、私の理解の中で、非情報工学専門の方向けに平易な表現を目指したものであり、一般に言うＡＩや生成ＡＩとしての厳密な表現を保証するものではありません。**（このため、これを一次資料とすることは厳禁とします）**
- 主な目的は「ＡＩは、Yes/Noだけでなく、かつ、その「程度」を計算して『もっともらしい結果（より近い結果）』を導き出すものであり、ＡＩが100点満点の正解を出すとは保証されていない」という理解への置き換えを目指すものとしています。
- その上で、本宣言上での生成ＡＩの直感的な理解として、上記のような理解とともに、「データベースから検索の結果として類似度が高くなるように組み合わせ、繰り返し採点を行い、最高点であるものを出力する」という概説を行うものです。

## 0.A. はじめに：検索エンジンについて

- ここでは、Google等の検索エンジンは通常、単語や文章の組み合わせに対し「求められている結果」を一覧表示する機能がある、と考えます。
- 単語や文章の解釈は分類や解釈がなされ、数値化されてその「類似度」の高い順で表現されます（これを意図的に利用したのが、SEO対策と呼ばれていたものだと認識しています）
- また、検索エンジンの多くには「～でない」という意味で単語の頭に「-(マイナス)」を付けることにより、除外することができるのですが、この説明の前に「ファジイ論理」という用語に触れておきます。

## 0.B. おおよその理解として

- ＡＩモデルは「人間にとって直感的なYes/Noのみを扱わず、無限個の選択肢を持つアンケートの結果の傾向をまとめたもの」と例えられます
- 例えば画像生成ＡＩにおいては、「画像と、それに付されたタグ（単語）がどの語群（単語のグループ）に類似しているか」をまとめたデータベースであるといえます
- （0.A.を踏まえて）画像生成ＡＩにおける「生成」は、image to image(i2i)ではまず画像を解析します。その後の処理はtext to image(t2i)も同様に、プロンプト（検索語）の指定に近くなるよう、画像をタグから検索し、「生成した画像の類似度を採点し、最高類似度となるよう数値の合成を繰り返す」仕組みで成立する、検索エンジンと例えることが出来ます
  - 「プロンプトに最も似ているコンテンツを生成せよ」という命令文を、生成ソフトウェアに送ることで、ソフトウェアが最高類似度のコンテンツを提示する、というように説明が出来ます
- また、text to text系の生成ＡＩ（GPT系など）は、プロンプト（入力した文章）が人間の扱う文法（自然言語）であっても、その構造を解析した上で検索語を抽出しているといえます。

## 1. ファジイ論理とは

以下、本宣言内の定義となります。

- 検索エンジン等の考え方として「<検索語>が含まれるか（近いか）」に対する回答をYes/Noで表すとします。コンピューターは、「Yes」を「1」、「No」を「0」として表現し、これを「論理値」と呼びます。（簡単な表現として「あるなしゲーム」を考えると分かりやすいと思います）
- ファジイ論理では通常、「0」と「1」の2つの値のみを取る（コンピューター内の電気的構造のON/OFFで表現出来るため）論理値を、「0から1の実数」の範囲で取ったものを指して言います。
  - この値の取り方で何に役立つかというと、「色の濃度」や「文体のかたさ」など、人間が曖昧(あいまい：fuzzy)に判断してより分けているものを、コンピューターにおいてもより細かく柔軟に表現することが出来ます。
  - しかし、人間にとって複雑な「（理屈上）無限個の選択肢」を持つため、直感的理解からは遠ざかりやすいため、本稿では簡単のために「３つ以上の選択肢」を持つ値として話を進めます。
- ただし、これはあくまでＡＩの基礎の前の、「用いられる値」であることに注意が必要です。

### ファジイ論理の表現例

- （あくまで例として）身長が高い・低いを170cm基準で分けるところを、身長の高さの「度合い」を150cm未満、150～160cm未満、150～160cm未満、160～170cm未満、170～180cm未満、180cm以上、というように分けるとする（下表1）。このとき、その境界値を0～1の値で置き換え、間は直線のグラフとして表せる)
  - 例えば、子供も含め、適切な救命胴衣をセンサーで身長や胴囲などを測定し、適切なサイズの救命胴衣を手渡せるようレーンに案内する、といったことも出来るでしょう。
- 他にも、例えばリンゴの鮮度を色で判別するとき、細かい等級で分けるときに「赤色の割合」で境界値を決めて、画像判定で仕分けを自動化する、といった用途が考えられます。これにより「作業者が傷のチェックや箱詰めに専念することが出来ること」が期待できます。

#### 下表1：例を表にしたもの

##### 変更前

|身長(h)|判定|論理値(p)範囲|
|---:|:---:|---:|
|h＜170cm|低い|p＝0|
|170cm≦h|高い|p＝1|

##### 変更後

|身長(h)|判定|論理値(p)範囲|
|---:|:---:|---:|
|h＜150cm|低い|p＝0.0|
|150≦h＜160cm|やや低い|0.0≦p＜0.2|
|160≦h＜170cm|中程度|0.25≦p＜0.5|
|170≦h＜180cm|やや高い|0.5≦p＜0.75|
|180≦h＜190cm|高い|0.75≦p＜1|
|190cm≦h|非常に高い|p＝1.0|

### 参考資料  

- [ファジィ論理 - Wikipedia](https://ja.wikipedia.org/wiki/%E3%83%95%E3%82%A1%E3%82%B8%E3%82%A3%E8%AB%96%E7%90%86)
- [それってホントに Deep Learning が必要ですか？ ～ MATLAB でファジィ推論イコライザー ～ 少ない主観ルールを元に高速推論｜leftbank](https://note.com/leftbank/n/n2b16648c9b39#2567301b-6fd8-45e1-9cd8-52ed3d803296)

## 2. 論理値とその拡張

ここまでで、感覚で捉えられるものを数値として測定し、0～1の間に収めて「程度」として表すことで、コンピューターでも処理しやすいということを何となくでも分かって頂けたらと思います。  

- その上で、検索エンジンの話に戻ります。ここまでは「高い」などといった「～である」ことを「1」、「～でない」を「0」という値にして表現しました。
- ここからは、**「0」を「高い(低い)とは言えない」という表現に置き換え、「低い」を「高い」の否定形の値「-1」として表現する**ことにします。

### 拡張した論理値表現の例

- アンケートや性格診断などの「当てはまらない」「どちらかというと当てはまらない」「どちらともいえない」「やや当てはまる」「当てはまる」
  - 日常の範囲では、このような５つまたは（「どちらかというと」を含まない）３つの選択肢で構成されることが多いはずです。
- アキネイターなど「想像したものに対し質問され、点数がより近い方のグループから答えと思われるものを導きだす」質問系

### 答えの「程度」を掛け算して「類似度」を出す

- アンケート調査や性格診断などのように、曖昧なものごとを「分類」しようとするとき、その答えは個々の「程度」（ここでは拡張した論理値）によって表れます。
  - 他にも、キャラクターのステータスに対する、目的に合わせた装備の組み合わせなども、この表現に置き換えることが出来ます。
- 質問への回答への組み合わせは単純計算でも「質問数×選択肢数」となり、より細かく分類したり、結果の精度を上げたりするときに、コンピューターにとって計算する量が多くなり、時間がかかってしまいます。
- そこで、「回答の組み合わせ」を「新たな回答」としてまとめ、その数を減らすことで、結果を出すまでの計算時間を減らすことが出来ます。
  - 例）アンケートの選択肢で「20代/30代」「男性/女性」という組み合わせの中で、「20代男性」「30代女性」が真逆の傾向（+1と-1の値）を取るとき、その類似度を新たな回答（一つの軸）とする
- ※上記の処理が統計の考え方の中にあり、生成ＡＩの話題で「統計」という表現が出ることはある程度正しいと考えています。

## 3. 検索エンジンとマイナス検索

- ここまでの話は、検索エンジンの単語それぞれを「質問」、検索結果との関連度を「程度」、検索結果の順番を「検索結果としての類似度順」としてみることが出来ます。
- それぞれ、検索エンジンでの検索に置き換えてみると、以下のように表現出来ます。
  - 「<検索語>が含まれる（当てはまる）」⇒ +1
  - 「<検索語>を含まない（当てはまらない）」⇒ -1
  - 検索語を書かない⇒-1～+1の間のどれでもよい
- <検索語A>と<検索語B>が真逆の言葉（「暑い」⇔「寒い」など）であるとき、これを１つの検索語としてまとめます
- また、<検索語A>と<検索語C>が近い意味を持つ場合、なるべく近い値になるように値を変換し、１つの検索語としてまとめます
- 以上の操作を繰り返し、軸の数（表計算ソフトで言えば数式の入るセルの数）を少なくすることで、コンピューター上での計算量を削減することができます

### 3.1. 計算量について

- コンピューターにおける「計算量」の意味は直感的な意味で差し支えないです
- 少し細かく説明すると、「計算時間（ハードウェアや処理の計算能力）」と「データ量」に大別されます
- ＡＩなど複雑なデータは、データ量も多く、計算時間も長くなりやすいものと考えることができます。
  - これを、LoRAなど（特定のグループを指定するよう値を設定し）圧縮したデータを用いて計算に使う対象となるデータ量を減らし、特定の検索語やデータを参照しやすくすることが出来るといえます。
- （例え）九九のうち、対角線を除く左下半分が、右上の対角線を挟んだマスと同じとみなして計算を省略する（計算する回数が半分余りになる）

#### 参考資料

- [ファジィ理論に基づく情報検索(<特集>類似尺度と情報検索)](https://www.jstage.jst.go.jp/article/jfuzzy/13/5/13_KJ00002087308/_article/-char/ja/)

## 生成ＡＩは検索エンジンであると例えられる理由の考察

- 「関連度順」の結果はどのように検索されているのでしょうか
  - 個人的な考えとして、ECサイトであれば「検索したフレーズ」「過去の購入履歴・検索履歴」などから推定されたものであると考えます。
  - これ自体は「レコメンド」「こちらもオススメです」などと表現され、購入に至れば双方にとって（売り上げ、商品を得られる）メリットがあり、比較的受け入れやすいものだと思います。
- しかしこれを生成ＡＩ、分かりやすい例で画像生成ＡＩに置き換えると、『あなたが見たい画像はこれですね』と表現できます。
  - この場合、権利者に利益が渡る構造すら出来ていないことが多く、またユーザーにその意識が低い様子が散見されます。
  - これでユーザーが収益化アカウントやブログ収益を上げているとしたら、そのほとんどは権利者が受け取るべきものであると考えます。

### 「データ内容」の共通点

- 個人情報保護の観点から、ECサイトなどでのレコメンドは個人情報を削除、あるいは属性のみでマスキングしているものと推察されます。
- 生成ＡＩは、「○○風の絵柄にして」とプロンプトを指定すれば（英数字の羅列でもそれが紐付く状況であれば）その絵柄を引き出す事が出来ます。
- これは、プロンプトが「検索ワード」の性質を持ち、その「関連度」が高くなるように画像を「寄せる」ものと見なせることは、決して大げさな話では無いと考えます。
- こういった理由から、生成ＡＩは「検索エンジン」の性質を持つと表現出来る、と考えています。

### 特に画像で、なぜ「○○さん」と思い込むのか。そこに関わる生成ＡＩの問題点

- 通常、イラストや漫画を始めとした、ビジュアル分野の作品を鑑賞する人は「○○の絵柄」を「○○さんの作品」として識別することが多いものです。
- 他方で、生成AIによる生成物は「絵柄を寄せる」ことが出来、経験者でなければ見抜けないような程度にまで（時には加筆して）似たものが投稿されることがあります
- 「○○さんの作品に似ている」作品を投稿するアカウントが、ユーザー名を偽ること、FA表記など正規の手続きを踏まないことででその識別の効果を高め、「○○さんのアカウントである」と誤認させることも可能です。
- 生成物は掛け算と足し算で「おおよそ100%似ている」程度まで引き上げられ、人間の目には、特に情報を追うのに忙しいSNSでは、その疑問を吟味する余裕がないことも、見落としに至る理由であると考えます。

